{
    "manifest_version": "1.0",
    "driver_id": "smo_snapchat_driver",
    "name": "Snapchat",
    "type": "ephemeral_visual",
    "icon": "assets/icons/snapchat.svg",
    "api_docs": "https://developers.snap.com/docs",

    "capabilities": {
        "text": true,
        "image": true,
        "video": true,
        "link_preview": false,
        "max_chars": 250,
        "max_images": 20,
        "allows_html": false,
        "best_image_ratio": "9:16"
    },

    "config_ui": [
        {
            "key": "snapchat_client_id",
            "label": "Client ID",
            "type": "text",
            "required": true,
            "help_text": "Your Snapchat Client ID from Snap Kit Developer Portal"
        },
        {
            "key": "snapchat_client_secret",
            "label": "Client Secret",
            "type": "password",
            "required": true,
            "encrypt": true,
            "help_text": "Your Snapchat Client Secret (will be encrypted)"
        },
        {
            "key": "snapchat_access_token",
            "label": "Access Token",
            "type": "password",
            "required": true,
            "encrypt": true,
            "help_text": "OAuth 2.0 access token with content publishing permissions"
        },
        {
            "key": "snapchat_organization_id",
            "label": "Organization ID",
            "type": "text",
            "required": true,
            "help_text": "Your Snapchat Organization ID for business account publishing"
        }
    ],

    "validation_rules": {
        "warnings": [
            {
                "condition": "content_length > 250",
                "message": "Snapchat captions are limited to 250 characters for optimal engagement."
            },
            {
                "condition": "image_count > 20",
                "message": "Snapchat allows up to 20 photos in a Snap or Story."
            },
            {
                "condition": "video_length > 60",
                "message": "Snapchat videos should be under 60 seconds for optimal viewing experience."
            },
            {
                "condition": "image_ratio == '16:9'",
                "message": "Snapchat performs best with vertical images (9:16 ratio) matching mobile screen."
            }
        ]
    },

    "api_interaction": {
        "auth_method": "oauth_2.0",
        "auth_endpoint": {
            "url": "https://accounts.snapchat.com/accounts/oauth2/auth",
            "method": "GET",
            "payload": {
                "response_type": "code",
                "client_id": "{{config.snapchat_client_id}}",
                "redirect_uri": "{{config.snapchat_redirect_uri}}",
                "scope": "write_content",
                "state": "{{state}}"
            }
        },
        
        "post_endpoint": {
            "url": "https://adsapi.snapchat.com/v5/me",
            "method": "POST",
            "headers": {
                "Authorization": "Bearer {{config.snapchat_access_token}}",
                "Content-Type": "application/json"
            }
        },

        "payload_map": {
            "caption": "{{post_content}} {{post_hashtags}}",
            "media": {
                "if": "{{has_media}}",
                "structure": {
                    "type": "{{media_type}}",
                    "url": "{{media_url}}",
                    "duration": "{{media_duration}}"
                }
            },
            "is_story": {
                "if": "{{post_to_story}}",
                "structure": true
            }
        }
    },

    "optimal_posting_times": ["17:00", "19:00", "21:00", "23:00", "01:00"],
    "engagement_factors": {
        "text_length": 0.4,
        "hashtags": 0.8,
        "media": 2.2,
        "time_of_day": 1.8,
        "day_of_week": 1.4
    },
    "trending_hashtags_source": "https://www.snapchat.com/discover/",
    "notes": "Ephemeral visual platform with AR features, Stories, and Discover content"
}