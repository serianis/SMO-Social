{
    "manifest_version": "1.0",
    "driver_id": "smo_mastodon_driver",
    "name": "Mastodon",
    "type": "decentralized_social",
    "icon": "assets/icons/mastodon.svg",
    "api_docs": "https://docs.joinmastodon.org/client/",

    "capabilities": {
        "text": true,
        "image": true,
        "video": false,
        "link_preview": true,
        "max_chars": 500,
        "max_images": 4,
        "allows_html": true,
        "best_image_ratio": "16:9"
    },

    "config_ui": [
        {
            "key": "mastodon_instance_url",
            "label": "Instance URL",
            "type": "text",
            "required": true,
            "help_text": "Your Mastodon instance URL (e.g., https://mastodon.social)"
        },
        {
            "key": "mastodon_access_token",
            "label": "Access Token",
            "type": "password",
            "required": true,
            "encrypt": true,
            "help_text": "Your Mastodon Access Token (will be encrypted)"
        },
        {
            "key": "mastodon_account_id",
            "label": "Account ID",
            "type": "text",
            "required": true,
            "help_text": "Your Mastodon Account ID for posting"
        }
    ],

    "validation_rules": {
        "warnings": [
            {
                "condition": "content_length > 500",
                "message": "Mastodon posts support up to 500 characters by default. Some instances may have different limits."
            },
            {
                "condition": "image_count > 4",
                "message": "Mastodon supports maximum 4 images per post."
            },
            {
                "condition": "has_videos",
                "message": "Mastodon doesn't natively support video uploads. Consider using alternative platforms."
            },
            {
                "condition": "content_length > 300",
                "message": "Longer posts may be truncated in some Mastodon clients. Keep concise for better readability."
            }
        ]
    },

    "api_interaction": {
        "auth_method": "bearer_token",
        "auth_endpoint": {
            "url": "{{config.mastodon_instance_url}}/api/v1/accounts/verify_credentials",
            "method": "GET",
            "headers": {
                "Authorization": "Bearer {{config.mastodon_access_token}}"
            }
        },
        
        "post_endpoint": {
            "url": "{{config.mastodon_instance_url}}/api/v1/statuses",
            "method": "POST",
            "headers": {
                "Authorization": "Bearer {{config.mastodon_access_token}}",
                "Content-Type": "application/json"
            }
        },

        "payload_map": {
            "status": "{{post_content}} {{post_hashtags}}",
            "visibility": "public",
            "sensitive": {
                "if": "{{has_nsfw_content}}",
                "structure": true
            },
            "media_ids": {
                "if": "{{has_images}}",
                "structure": "{{mapped_media_ids}}"
            },
            "in_reply_to_id": {
                "if": "{{reply_to}}",
                "structure": "{{reply_to}}"
            }
        }
    },

    "optimal_posting_times": ["09:00", "12:00", "15:00", "18:00", "21:00"],
    "engagement_factors": {
        "text_length": 0.6,
        "hashtags": 0.7,
        "media": 1.1,
        "time_of_day": 0.8,
        "day_of_week": 0.6
    },
    "trending_hashtags_source": "{{config.mastodon_instance_url}}/api/v1/tags/trending",
    "notes": "Decentralized federated social network with open-source ethos and community-driven moderation"
}